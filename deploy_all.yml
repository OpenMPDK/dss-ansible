---

- name: Deploy Servers
  hosts: servers
  pre_tasks:
    - name: Verify minimum Ansible version
      assert:
        that: "ansible_version.full is version_compare('2.9', '>=')"
        msg: "You must update Ansible to at least 2.9 to use this playbook"
      run_once: true
  roles:
    - validate_centos
    - deploy_kernel
    - deploy_ofed
    - load_mlnx_drivers
    - upgrade_ofed_firmware
