---

- name: Verify minimum Ansible version
  hosts: servers
  pre_tasks:
    - name: Verify minimum Ansible version
      assert:
        that: "ansible_version.full is version_compare('2.9', '>=')"
        msg: "You must update Ansible to at least 2.9 to use this playbook"
      run_once: true

- name: Configure Hosts
  import_playbook: configure_hosts.yml

- name: Configure VLANs
  import_playbook: configure_vlans.yml

- name: Upgrade KVSSD Firmware
  import_playbook: upgrade_kvssd_firmware.yml

- name: Deploy DSS Software
  import_playbook: deploy_dss_software.yml
