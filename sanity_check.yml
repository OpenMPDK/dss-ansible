---

- name: Sanity Check RoCEv2
  hosts: servers
  pre_tasks:
    - name: Verify minimum Ansible version
      assert:
        that: "ansible_version.full is version_compare('2.9', '>=')"
        msg: "You must update Ansible to at least 2.9 to use this playbook"
      run_once: true
  vars:
    vlan_list: "{{ rocev2_vlans }}"
  roles:
    - sanity_check_ping

- name: Sanity Check TCP
  hosts:
    - clients
    - servers
  vars:
    vlan_list: "{{ tcp_vlans }}"
  roles:
    - sanity_check_ping
