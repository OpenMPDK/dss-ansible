---

- name: Set list of detected OFED files
  set_fact:
    ofed_files: "{{ ofed_files | default([]) +
                        [{'url': item,
                          'filename': item | basename,
                          'dir': item | basename | regex_search(ofed_regex, '\\1') | first,
                          'version': item | basename | regex_search(ofed_regex, '\\2') | first,
                          'distribution_version': item | basename | regex_search(ofed_regex, '\\3') | first }] }}"
  loop: "{{ ofed_versions }}"
  run_once: true
  vars:
    ofed_regex: '(MLNX_OFED_LINUX-(.+)-rhel([\d]\.[\d])-x86_64).tgz$'
