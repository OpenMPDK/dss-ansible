---

- name: Get list of Mellanox ports
  include_role:
    name: get_mlnx_ports
  when: mellanox_ports is not defined

- name: Initialize vlan_device_list variable
  set_fact:
    vlan_device_list: []

- name: Get list of VLAN devices
  include_tasks: get_vlan_devices.yml
  loop: "{{ mellanox_ports }}"
  vars:
    mellanox_device: "{{ item }}"
  loop_control:
    label: "{{ item.ibdev }}"
