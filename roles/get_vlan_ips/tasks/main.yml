---

- name: Get list of Mellanox ports
  include_role:
    name: get_mlnx_ports
  when: mellanox_ports is not defined

- name: Initialize vlan_ip_list variable
  set_fact:
    vlan_ip_list: []

- name: Get list of VLAN IP addresses
  include_tasks: get_vlan_ips.yml
  loop: "{{ mellanox_ports }}"
  vars:
    mellanox_device: "{{ item }}"
  loop_control:
    label: "{{ item.ibdev }}"
