---

- name: Get list of Mellanox adapters
  include_role:
    name: get_mlnx_devices
  when: mellanox_devices is not defined

- name: Get list of RoCEv2 VLANs
  include_tasks: get_vlan_list.yml
  loop: "{{ rocev2_vlans }}"
  loop_control:
    loop_var: vlan
    label: "VLAN ID: {{ vlan.id }}"
  vars:
    vlan_prefix: RoCE_vlan

- name: Get list of TCP VLANs
  include_tasks: get_vlan_list.yml
  loop: "{{ tcp_vlans }}"
  loop_control:
    loop_var: vlan
    label: "VLAN ID: {{ vlan.id }}"
  vars:
    vlan_prefix: TCP_vlan
