---

- name: Install tuned
  yum:
    name: tuned
  become: true

- name: Start and enable tuned service
  service:
    name: tuned
    state: started
    enabled: true
  become: true

- name: Check tuned active profile
  command: tuned-adm active
  changed_when: false
  register: tuned_active
  become: true

- name: Set tuned off
  command: tuned-adm off
  when: "'throughput-performance' not in tuned_active.stdout"
  become: true

- name: Set tuned profile
  command: tuned-adm profile throughput-performance
  when: "'throughput-performance' not in tuned_active.stdout"
  become: true
